<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>Tic tac toe</title>
</head>

<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.1.2/socket.io.min.js"></script>
    <script src="pixi.js"></script>
    <script src="PIXI.TextInput.min.js"></script>
    <script src="game.js"></script>
    <script src="start.js"></script>
    <script src="menu.js"></script>
    <script src="utils.js"></script>
    <style>
        * {
            padding: 0;
            margin: 0
        }
    </style>
    <script type="text/javascript">

        const socket = io("https://MiniatureShamefulNotifications.fabriziochimien.repl.co", { autoConnect: false });
        // socket.connect();

        // socket.on('welcome', function (data) {
        //     console.log(data.message)

        //     // Respond with a message including this clients' id sent from the server
        //     socket.emit('i am client', { data: 'foo!', id: data.id });
        // });
        socket.on('joined', function (data) {
            console.log(data.message)
            utils.clearGraphics(app)
            game.player = data.player
            game.gameEnd = false
            game.turn = 0
            game.boxSize = null
            game.setupBoard()
            game.setupGraphicBoard(app, 10)
        });

        socket.on('roomfull', function (data) {
            console.log(data.message)
        });
        socket.on('error', console.error.bind(console));
        socket.on('message', console.log.bind(console));
        socket.on('moved', function (data) {
            console.log('move')
            console.log(data)
            console.log(game.board)
            game.opponentMove(app, data.b)
        });

        socket.on("disconnect", () => {
            console.log(socket.connected); // false
        });
        let turn = 0

        let type = "WebGL"
        if (!PIXI.utils.isWebGLSupported()) {
            type = "canvas"
        }

        //Create a Pixi Application
        let app = null
        app = new PIXI.Application({
            width: 256,
            height: 256,
            antialias: true,
            transparent: false,
            resolution: 1
        }
        );



        function startApp() {
            utils.clearGraphics(app)
            app.renderer.backgroundColor = 0x061639;
            app.renderer.view.style.position = "absolute";
            app.renderer.view.style.display = "block";
            app.renderer.autoResize = true;
            app.renderer.resize(window.innerWidth, window.innerHeight);

            window.onresize = function () {
                app.renderer.autoResize = true;
                app.renderer.resize(window.innerWidth, window.innerHeight);
            }
            document.body.appendChild(app.view);
            menu.createMenu(app)
        }
        startApp()
    </script>
</body>

</html>